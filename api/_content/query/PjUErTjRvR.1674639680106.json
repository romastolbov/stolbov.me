{"_path":"/deploy-nuxtjs-v3-to-github-pages","_dir":"","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"Деплой Nuxt.js v3 проекта на GitHub Pages","description":"Нельзя просто так взять и задеплоить","excerpt":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Если создать свежий проект на Nuxt.js 3, сгенерировать статику, запушить все это\nдело на GitHub и попробовать подключить GitHub Pages – работать оно, конечно, будет, но очень криво."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"В консоли можно будет наблюдать кучу ошибок 404, исходя из этого, можно сделать вывод,\nчто мы либо похерили часть файлов на этапе сборки, либо лежат они не там где нам нужно."}]},{"type":"element","tag":"h2","props":{"id":"почему-так-происходит"},"children":[{"type":"text","value":"Почему так происходит"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Данная проблема возникает из-за того что GitHub Pages под капотом использует\nгенератор статических сайтов "},{"type":"element","tag":"a","props":{":target":"_blank","href":"https://jekyllrb.com/","rel":["nofollow"]},"children":[{"type":"text","value":"Jekyll"}]},{"type":"text","value":",\nкоторый игнорирует файлы и папки, названия которых начинаются с символов: "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"."}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"_"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"#"}]},{"type":"text","value":"или"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"~"}]},{"type":"text","value":"."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Every file or directory beginning with the following characters: ., _ , # or ~ in the\nsource directory will not be included in the destination folder.\nSuch paths will have to be explicitly specified via the config file in the\ninclude directive to make sure they’re copied over:"}]},{"type":"element","tag":"code","props":{"code":"include:\n- _pages\n- .htaccess\n"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"include:\n- _pages\n- .htaccess\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"А, как мы знаем, наш любимый Nuxt.js складывает все свои скрипты в папку под названием "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/_nuxt"}]},{"type":"text","value":",\nкоторая впоследствии благополучно игнорируется Jekyll. Кроме того, c внедрением в Nuxt.js функционала\nFull Static Generator, полезная нагрузка запросов стала выделяться в отдельный модуль "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"_payload.js"}]},{"type":"text","value":",\nкоторый также не будет обрабатываться."}]},{"type":"element","tag":"h2","props":{"id":"как-это-исправить"},"children":[{"type":"text","value":"Как это исправить"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Как оказалось, данная проблема уже имеет официальное\n"},{"type":"element","tag":"a","props":{":target":"\\_blank","href":"https://github.blog/2009-12-29-bypassing-jekyll-on-github-pages/","rel":["nofollow"]},"children":[{"type":"text","value":"решение"}]},{"type":"text","value":" от команды GitHub.\nВсё что нужно сделать – добавить специальный пустой файл "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":".nojekyll"}]},{"type":"text","value":" в корень проекта, который\nсообщит что для данной сборки использовать Jekyll не нужно."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Поэтому в корне нашего Nuxt.js проекта создаем папку "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/public"}]},{"type":"text","value":" и складываем туда пустой файл\nс названием "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":".nojekyll"}]},{"type":"text","value":", пересобираем билд через "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"yarn generate"}]},{"type":"text","value":", делаем коммит и пушим."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Если вы деплоите с помощью утилиты "},{"type":"element","tag":"a","props":{":target":"\\_blank","href":"https://www.npmjs.com/package/gh-pages","rel":["nofollow"]},"children":[{"type":"text","value":"gh-pages"}]},{"type":"text","value":",\nто, кроме всего прочего, необходимо в скрипт деплоя "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"gh-pages -d dist"}]},{"type":"text","value":" добавить флаг "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"--dotfiles"}]},{"type":"text","value":".\nБез него файл "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":".nojekyll"}]},{"type":"text","value":" не попадет в финальную сборку."}]}]},{"type":"element","tag":"h2","props":{"id":"если-всё-еще-не-завелось"},"children":[{"type":"text","value":"Если всё еще не завелось"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Даже если отключить Jekyll, файлы по-прежнему будут недоступны, но уже по причине их неверного URL.\nЕсли внимательно посмотреть на ошибки 404, то можно увидеть, что вызваны они отсутствием файлов\nпримерно по такому адресу:"}]},{"type":"element","tag":"code","props":{"code":"https://username.github.io/_nuxt/entry.f4606515.js\n"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"https://username.github.io/_nuxt/entry.f4606515.js\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"При этом GitHub Pages генерирует и размещает проекты на URL следующего вида:"}]},{"type":"element","tag":"code","props":{"code":"https://username.github.io/reponame/\n"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"https://username.github.io/reponame/\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Т.е. стучимся мы не туда (отсутствует название репозитория).\nРешить данную проблему можно очень просто двумя способами:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Прикрутить собственный домен"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Указать "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"baseUrl"}]},{"type":"text","value":" в файле "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"nuxt.config.js"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"baseUrl"}]},{"type":"text","value":" указывается в конфигурации Nuxt.js следующим образом:"}]},{"type":"element","tag":"code","props":{"code":"export default defineNuxtConfig({\n  app: {\n    baseURL: \"/reponame/\",\n  },\n});\n","language":"javascript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"export default defineNuxtConfig({\n  app: {\n    baseURL: \"/reponame/\",\n  },\n});\n"}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Чтобы собственный домен не слетал каждый раз после очередного деплоя,\nнужно в папку "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/public"}]},{"type":"text","value":" добавить файл с названием "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"CNAME"}]},{"type":"text","value":" и указать там домен,\nкоторый привязали в формате "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"example.com"}]}]}]},{"type":"element","tag":"h3","props":{"id":"ссылочная"},"children":[{"type":"text","value":"Ссылочная:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{":target":"\\_blank","href":"https://jekyllrb.com/","rel":["nofollow"]},"children":[{"type":"text","value":"Jekyll"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{":target":"\\_blank","href":"https://www.npmjs.com/package/gh-pages","rel":["nofollow"]},"children":[{"type":"text","value":"gh-pages"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{":target":"\\_blank","href":"https://github.blog/2009-12-29-bypassing-jekyll-on-github-pages/","rel":["nofollow"]},"children":[{"type":"text","value":"Bypassing Jekyll On Github Pages"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{":target":"\\_blank","href":"https://nuxtjs.org/deployments/github-pages/","rel":["nofollow"]},"children":[{"type":"text","value":"Deploy Nuxt v2 on GitHub Pages"}]}]}]}]},"date":"5 января, 2023","tags":["dev"],"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Если создать свежий проект на Nuxt.js 3, сгенерировать статику, запушить все это\nдело на GitHub и попробовать подключить GitHub Pages – работать оно, конечно, будет, но очень криво."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"В консоли можно будет наблюдать кучу ошибок 404, исходя из этого, можно сделать вывод,\nчто мы либо похерили часть файлов на этапе сборки, либо лежат они не там где нам нужно."}]},{"type":"element","tag":"h2","props":{"id":"почему-так-происходит"},"children":[{"type":"text","value":"Почему так происходит"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Данная проблема возникает из-за того что GitHub Pages под капотом использует\nгенератор статических сайтов "},{"type":"element","tag":"a","props":{":target":"_blank","href":"https://jekyllrb.com/","rel":["nofollow"]},"children":[{"type":"text","value":"Jekyll"}]},{"type":"text","value":",\nкоторый игнорирует файлы и папки, названия которых начинаются с символов: "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"."}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"_"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"#"}]},{"type":"text","value":"или"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"~"}]},{"type":"text","value":"."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Every file or directory beginning with the following characters: ., _ , # or ~ in the\nsource directory will not be included in the destination folder.\nSuch paths will have to be explicitly specified via the config file in the\ninclude directive to make sure they’re copied over:"}]},{"type":"element","tag":"code","props":{"code":"include:\n- _pages\n- .htaccess\n"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"include:\n- _pages\n- .htaccess"}]}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"А, как мы знаем, наш любимый Nuxt.js складывает все свои скрипты в папку под названием "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/_nuxt"}]},{"type":"text","value":",\nкоторая впоследствии благополучно игнорируется Jekyll. Кроме того, c внедрением в Nuxt.js функционала\nFull Static Generator, полезная нагрузка запросов стала выделяться в отдельный модуль "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"_payload.js"}]},{"type":"text","value":",\nкоторый также не будет обрабатываться."}]},{"type":"element","tag":"h2","props":{"id":"как-это-исправить"},"children":[{"type":"text","value":"Как это исправить"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Как оказалось, данная проблема уже имеет официальное\n"},{"type":"element","tag":"a","props":{":target":"\\_blank","href":"https://github.blog/2009-12-29-bypassing-jekyll-on-github-pages/","rel":["nofollow"]},"children":[{"type":"text","value":"решение"}]},{"type":"text","value":" от команды GitHub.\nВсё что нужно сделать – добавить специальный пустой файл "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":".nojekyll"}]},{"type":"text","value":" в корень проекта, который\nсообщит что для данной сборки использовать Jekyll не нужно."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Поэтому в корне нашего Nuxt.js проекта создаем папку "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/public"}]},{"type":"text","value":" и складываем туда пустой файл\nс названием "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":".nojekyll"}]},{"type":"text","value":", пересобираем билд через "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"yarn generate"}]},{"type":"text","value":", делаем коммит и пушим."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Если вы деплоите с помощью утилиты "},{"type":"element","tag":"a","props":{":target":"\\_blank","href":"https://www.npmjs.com/package/gh-pages","rel":["nofollow"]},"children":[{"type":"text","value":"gh-pages"}]},{"type":"text","value":",\nто, кроме всего прочего, необходимо в скрипт деплоя "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"gh-pages -d dist"}]},{"type":"text","value":" добавить флаг "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"--dotfiles"}]},{"type":"text","value":".\nБез него файл "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":".nojekyll"}]},{"type":"text","value":" не попадет в финальную сборку."}]}]},{"type":"element","tag":"h2","props":{"id":"если-всё-еще-не-завелось"},"children":[{"type":"text","value":"Если всё еще не завелось"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Даже если отключить Jekyll, файлы по-прежнему будут недоступны, но уже по причине их неверного URL.\nЕсли внимательно посмотреть на ошибки 404, то можно увидеть, что вызваны они отсутствием файлов\nпримерно по такому адресу:"}]},{"type":"element","tag":"code","props":{"code":"https://username.github.io/_nuxt/entry.f4606515.js\n"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"https://username.github.io/_nuxt/entry.f4606515.js"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"При этом GitHub Pages генерирует и размещает проекты на URL следующего вида:"}]},{"type":"element","tag":"code","props":{"code":"https://username.github.io/reponame/\n"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"https://username.github.io/reponame/"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Т.е. стучимся мы не туда (отсутствует название репозитория).\nРешить данную проблему можно очень просто двумя способами:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Прикрутить собственный домен"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Указать "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"baseUrl"}]},{"type":"text","value":" в файле "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"nuxt.config.js"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"baseUrl"}]},{"type":"text","value":" указывается в конфигурации Nuxt.js следующим образом:"}]},{"type":"element","tag":"code","props":{"code":"export default defineNuxtConfig({\n  app: {\n    baseURL: \"/reponame/\",\n  },\n});\n","language":"javascript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-f5d929"},"children":[{"type":"text","value":"export"}]},{"type":"element","tag":"span","props":{"class":"ct-0b9e0e"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f5d929"},"children":[{"type":"text","value":"default"}]},{"type":"element","tag":"span","props":{"class":"ct-0b9e0e"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-17f727"},"children":[{"type":"text","value":"defineNuxtConfig"}]},{"type":"element","tag":"span","props":{"class":"ct-5e1e1e"},"children":[{"type":"text","value":"({"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0b9e0e"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-e76335"},"children":[{"type":"text","value":"app"}]},{"type":"element","tag":"span","props":{"class":"ct-5e1e1e"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-0b9e0e"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5e1e1e"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0b9e0e"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e76335"},"children":[{"type":"text","value":"baseURL"}]},{"type":"element","tag":"span","props":{"class":"ct-5e1e1e"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-0b9e0e"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-7688d7"},"children":[{"type":"text","value":"\"/reponame/\""}]},{"type":"element","tag":"span","props":{"class":"ct-5e1e1e"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0b9e0e"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-5e1e1e"},"children":[{"type":"text","value":"},"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-5e1e1e"},"children":[{"type":"text","value":"});"}]}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Чтобы собственный домен не слетал каждый раз после очередного деплоя,\nнужно в папку "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/public"}]},{"type":"text","value":" добавить файл с названием "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"CNAME"}]},{"type":"text","value":" и указать там домен,\nкоторый привязали в формате "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"example.com"}]}]}]},{"type":"element","tag":"h3","props":{"id":"ссылочная"},"children":[{"type":"text","value":"Ссылочная:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{":target":"\\_blank","href":"https://jekyllrb.com/","rel":["nofollow"]},"children":[{"type":"text","value":"Jekyll"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{":target":"\\_blank","href":"https://www.npmjs.com/package/gh-pages","rel":["nofollow"]},"children":[{"type":"text","value":"gh-pages"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{":target":"\\_blank","href":"https://github.blog/2009-12-29-bypassing-jekyll-on-github-pages/","rel":["nofollow"]},"children":[{"type":"text","value":"Bypassing Jekyll On Github Pages"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{":target":"\\_blank","href":"https://nuxtjs.org/deployments/github-pages/","rel":["nofollow"]},"children":[{"type":"text","value":"Deploy Nuxt v2 on GitHub Pages"}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-7688d7{color:#C98A7D}\n.ct-e76335{color:#E0A569}\n.ct-5e1e1e{color:#858585}\n.ct-17f727{color:#A1B567}\n.ct-0b9e0e{color:#DBD7CA}\n.ct-f5d929{color:#4D9375}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"почему-так-происходит","depth":2,"text":"Почему так происходит"},{"id":"как-это-исправить","depth":2,"text":"Как это исправить"},{"id":"если-всё-еще-не-завелось","depth":2,"text":"Если всё еще не завелось","children":[{"id":"ссылочная","depth":3,"text":"Ссылочная:"}]}]}},"_type":"markdown","_id":"content:deploy-nuxtjs-v3-to-github-pages.md","_source":"content","_file":"deploy-nuxtjs-v3-to-github-pages.md","_extension":"md"}